name: Manual Build and Release

on:
  workflow_dispatch:
    inputs:
      tag_name:
        description: "Tag to create (e.g. v1.0.0)"
        required: true
      release_name:
        description: "Release display name (optional)"
        required: false
        default: ""
      overwrite_release:
        description: "If true, delete existing release with the same tag before creating (CAREFUL)"
        required: false
        default: "true"
      draft:
        description: "Create release as draft? (true/false)"
        required: false
        default: "false"
      prerelease:
        description: "Create release as prerelease? (true/false)"
        required: false
        default: "false"
      main_py_file:
        description: "Main python file to package"
        required: false
        default: "generator.py"
      python_version:
        description: "Python version"
        required: false
        default: "3.10"

permissions:
  contents: write

jobs:
  build_and_release:
    uses: ./.github/workflows/reusable-build-release.yml
    with:
      tag_name: ${{ inputs.tag_name }}
      release_name: ${{ inputs.release_name }}
      overwrite_release: ${{ inputs.overwrite_release }}
      draft: ${{ inputs.draft }}
      prerelease: ${{ inputs.prerelease }}
      main_py_file: ${{ inputs.main_py_file }}
      python_version: ${{ inputs.python_version }}
    secrets: inherit
